Zilog eZ8 Encore! Macro Assembler Version 2.53 (14010603) 03-May-15     17:12:26     page:   1


PC     Object              I  Line    Source 
                           A     1    ; Filename: monovideo3.asm
                           A     2    ; Author: Koen van Vliet <8by8mail@gmail.com>
                           A     3    ; Description: Test with monochrome video using
                           B     0    include "ez8.inc"
                           B     1    ;**********************************************
                           B     2    ;*  Copyright (C) 1999-2006 by  Zilog, Inc.
                           B     3    ;*  All Rights Reserved
                           B     4    ;**********************************************
                           B     5    
                           B   955    	.list on
                           B   956    
                           B   957    
     01312D00              A     5    sysFreq		equ		20_000_000
     00000040              A     6    hTime		equ		64
     00000004              A     7    hSyncTime	equ		4
                           A     8    
                           A     9    vBuff		equ		RR10
                           A    10    vBuffH		equ		R10
                           A    11    vBuffL		equ		R11
                           A    12    isrVect		equ		RR14
                           A    13    isrVectH	equ		R14
                           A    14    isrVectL	equ		R15
                           A    15    hCharCnt	equ		R12
                           A    16    vLineCnt	equ		R13
     00000024              A    17    hChars		equ		36
     00000008              A    18    cWidth		equ		8
                           A    19    
     00000023              A    20    t0Interval	var		hTime * sysFreq / (hChars *
     00000050              A    21    t1hSync		equ		hSyncTime * sysFreq / 1000_
                           A    22    
     00000001              A    23    DDR			equ		1
     00000002              A    24    AF			equ		2
                           A    25    
     00000002              A    26    spiPrescaler	equ	2
                           A    27    
                           A    28    if t0Interval < (cWidth + 1) * spiPrescaler * 2
     00000024              A    29    	t0Interval	var	(cWidth + 1) * spiPrescaler
                           A    30    	warning "Timing requirements not met! Overr
-----WARNING (576) Timing requirements not met! Overriding horizontal character 
                           A    31    endif
                           A    32    
                           A    33    if	cWidth = 8
     00000000              A    34    	spiLen		equ		0
                           A    35    else
                           A    36    	spiLen		equ		cWidth
                           A    37    endif
                           A    38    
0002 0200                  A    39    vector	RESET = init
000C 026E                  A    40    vector timer0 = isrT0
                           A    41    org 0200h
0200 8F                    A    42    init		di									0201 0100                  A    43    			srp		#00h						Zilog eZ8 Encore! Macro Assembler Version 2.53 (14010603) 03-May-15     17:12:26     page:   2


PC     Object              I  Line    Source C:\users\koen\MY_D~D41\src\ez8\MONO~W2G\monovideo3.asm
0203 E9000FFE              A    44    			ldx		SPH,#00h					0207 E9FF0FFF              A    45    			ldx		SPL,#FFh
                           A    46    
020B E9010FD8              A    47    initSpi		ldx		PCADDR,#DDR					020F E9EF0FD9              A    48    			ldx		PCCTL,#~(1<<4)
0213 E9020FD8              A    49    			ldx		PCADDR,#AF					0217 E9100FD9              A    50    			ldx		PCCTL,#(1<<4)				021B E9030F61              A    51    			ldx		SPICTL,#(1<<1)|(1<<0)		021F E9000F63              A    52    			ldx		SPIMODE,#(spiLen << 2)		0223 E9000F66              A    53    			ldx		SPIBRH,#HIGH(spiPrescaler)	0227 E9020F67              A    54    			ldx		SPIBRL,#LOW(spiPrescaler)
                           A    55    
022B E9000F07              A    56    			ldx		T0CTL1,#0					022F E9000F06              A    57    			ldx		T0CTL0,#0					0233 E9000F02              A    58    			ldx		T0RH,#HIGH(t0Interval)		0237 E9240F03              A    59    			ldx		T0RL,#LOW(t0Interval)		023B E9010F07              A    60    			ldx		T0CTL1,#(1<<0)				023F E9200FC1              A    61    			ldx		IRQ0ENH,#(1<<5)				0243 E9200FC2              A    62    			ldx		IRQ0ENL,#(1<<5)
                           A    63    			
0247 E9000F0F              A    64    			ldx		T1CTL1,#0					024B E9000F0E              A    65    			ldx		T1CTL0,#0					024F E9000F0A              A    66    			ldx		T1RH,#HIGH(t1hSync)			0253 E9500F0B              A    67    			ldx		T1RL,#LOW(t1hSync)
0257 E9400F0F              A    68    			ldx		T1CTL1,#(1<<6)				                           A    69    
025B E9020FD8              A    70    initGPIO	ldx		PCADDR,#AF					025F 49020FD9              A    71    			orx		PCCTL,#(1<<1)			
                           A    72    			
0263 EC 02                 A    73    startVideo	ld		isrVectH,#HIGH(sync)
0265 FC 70                 A    74    			ld		isrVectL,#LOW(sync)
0267 49800F07              A    75    			orx		T0CTL1,#(1<<7)				026B 9F                    A    76    			ei									026C                       A    77    $$			; Do stuff
026C 8B FE                 A    78    			jr		$B
                           A    79    
026E C4EE                  A    80    isrT0		jp		@isrVect
                           A    81    
0270 59BF0F0F              A    82    sync		andx	T1CTL1,#~(1<<6)				0274 49800F0F              A    83    			orx		T1CTL1,#(1<<7)
0278 49400F0F              A    84    			orx		T1CTL1,#(1<<6)
027C EC 02                 A    85    			ld		isrVectH,#HIGH(fetch)
027E FC 83                 A    86    			ld		isrVectL,#LOW(fetch)
0280 BCFF                  A    87    			ld		vBuffL,#FFh					0282 BF                    A    88    			iret
                           A    89    
0283 94BF60                A    90    fetch		ldx		SPIDATA,vBuffL
0286 CA 06                 A    91    			djnz	hCharCnt,$F
0288 CC24                  A    92    			ld		hCharCnt,#hChars
028A EC 02                 A    93    			ld		isrVectH,#HIGH(sync)
028C FC 70                 A    94    			ld		isrVectL,#LOW(sync)
028E                       A    95    $$			;ldc		vBuffL,
Zilog eZ8 Encore! Macro Assembler Version 2.53 (14010603) 03-May-15     17:12:26     page:   3


PC     Object              I  Line    Source C:\users\koen\MY_D~D41\src\ez8\MONO~W2G\monovideo3.asm
028E BF                    A    96    			iret
                           A    97    			


Errors: 0
Warnings: 1
Lines Assembled: 2207
